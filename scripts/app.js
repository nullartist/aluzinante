(()=>{"use strict";const e=e=>{if(void 0===e)return{};let t=null!==e.acceleration&&void 0!==e.acceleration?{acceleration:e.acceleration}:{};return null!==e.position&&void 0!==e.position&&(t={...t,position:e.position}),null!==e.velocity&&void 0!==e.velocity?{...t,velocity:e.velocity}:t},t=(e,t)=>{const{acceleration:n,position:r,timestamp:i,velocity:o}=e;return{acceleration:n,position:r+o*t+.5*n*t**2,timestamp:i+t,velocity:o+n*t}},n=((e,t,n,r,i,o,s,u)=>class extends r{constructor(e={},t=Number.NEGATIVE_INFINITY,n=Number.POSITIVE_INFINITY){super();const{timingProviderSource:r,vector:u}=void 0===e.update?{timingProviderSource:null,vector:e}:{timingProviderSource:e,vector:{}};if(this._endPosition=null===r?n:r.endPosition,this._onchange=null,this._onerror=null,this._onreadystatechange=null,this._readyState=null===r?"open":r.readyState,this._skew=null===r?0:r.skew,this._startPosition=null===r?t:r.startPosition,this._timingProviderSource=r,this._timeoutId=null,this._vector=null===r?{acceleration:0,position:0,velocity:0,...i(u),timestamp:o.now()/1e3}:r.vector,n<this._vector.position&&(this._vector={...this._vector,acceleration:0,position:n,velocity:0}),t>this._vector.position&&(this._vector={...this._vector,acceleration:0,position:t,velocity:0}),this._setInternalTimeout(),null===r)s((()=>this.dispatchEvent(new Event("readystatechange"))));else{const e=()=>{this._skew=r.skew},t=()=>this._setInternalVector(r.vector),n=()=>{this._isAllowedTransition(r.readyState)?this._readyState=r.readyState:(this._readyState="closed",r.removeEventListener("adjust",e),r.removeEventListener("change",t),r.removeEventListener("readystatechange",n)),null!==r.error&&s((()=>this.dispatchEvent(new ErrorEvent("error",{error:r.error})))),s((()=>this.dispatchEvent(new Event("readystatechange"))))};r.addEventListener("adjust",e),r.addEventListener("change",t),r.addEventListener("readystatechange",n)}}get endPosition(){return this._endPosition}get onchange(){return null===this._onchange?this._onchange:this._onchange[0]}set onchange(e){if(null!==this._onchange&&this.removeEventListener("change",this._onchange[1]),"function"==typeof e){const t=e.bind(this);this.addEventListener("change",t),this._onchange=[e,t]}else this._onchange=null}get onerror(){return null===this._onerror?this._onerror:this._onerror[0]}set onerror(e){if(null!==this._onerror&&this.removeEventListener("error",this._onerror[1]),"function"==typeof e){const t=e.bind(this);this.addEventListener("error",t),this._onerror=[e,t]}else this._onerror=null}get onreadystatechange(){return null===this._onreadystatechange?this._onreadystatechange:this._onreadystatechange[0]}set onreadystatechange(e){if(null!==this._onreadystatechange&&this.removeEventListener("readystatechange",this._onreadystatechange[1]),"function"==typeof e){const t=e.bind(this);this.addEventListener("readystatechange",t),this._onreadystatechange=[e,t]}else this._onreadystatechange=null}get readyState(){return this._readyState}get startPosition(){return this._startPosition}get timingProviderSource(){return this._timingProviderSource}query(){if("open"!==this._readyState)throw n();const e=o.now()/1e3,t=null===this._timingProviderSource?e-this._vector.timestamp:e+this._skew-this._vector.timestamp,r=u(this._vector,t);return this._endPosition<r.position||this._startPosition>r.position?(this._setInternalVector({...r,acceleration:0,position:this._endPosition<r.position?this._endPosition:this._startPosition,velocity:0}),this.query()):r}update(e){if("open"!==this._readyState)return Promise.reject(n());if(null!==this._timingProviderSource){const t=this._timingProviderSource.update(e);return t instanceof Promise?t:Promise.reject(new TypeError("The timingProviderSource failed to return a promise."))}const t=i(e);if(0===Object.keys(t).length)return Promise.resolve();const r={...this.query(),...t},{position:o,velocity:s,acceleration:u}=r;return o<this._startPosition||o>this._endPosition||o===this._startPosition&&(s<0||0===s&&u<0)||o===this._endPosition&&(s>0||0===s&&u>0)?Promise.reject((()=>{try{return new DOMException("","IllegalValueError")}catch(e){return e.name="IllegalValueError",e}})()):(this._setInternalVector(r),Promise.resolve())}_isAllowedTransition(e){return"closing"===this._readyState&&"closed"===e||"connecting"===this._readyState||"open"===this._readyState&&("closed"===e||"closing"===e)}_setInternalTimeout(){if(null!==this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=null),this._endPosition===Number.POSITIVE_INFINITY&&this._startPosition===Number.NEGATIVE_INFINITY||0===this._vector.acceleration&&0===this._vector.velocity)return;const t=e(this._vector,this._startPosition,this._endPosition);null!==t&&(this._timeoutId=s((()=>this.query()),t))}_setInternalVector(e){this._vector=e,this._setInternalTimeout(),s((()=>this.dispatchEvent(new Event("change"))))}})((o=({acceleration:e,position:t,velocity:n},r)=>{const i=((e,t,n,r)=>{if(0===n&&0===t)return e!==r?[]:[0];if(0===n)return[(r-e)/t];const i=t/n,o=Math.sqrt(i**2-2/n*(e-r));return[o-i,-(o+i)].filter((e=>!isNaN(e))).sort()})(t,n,e,r);if(0===i.length)return null;if(1===i.length)return i[0]>0?i[0]:null;if(2===i.length){if(i[1]<0)return null;if(i[0]>0)return i[0];if(i[1]>0)return i[1]}return null},i=(e,t,n)=>{const r=o(e,t),i=o(e,n);return null!==r&&null!==i?r<i?r:i:null!==r?r:null!==i?i:null},(e,t,n)=>{const r=i(e,t,n);return null===r||r===Number.POSITIVE_INFINITY?null:r}),0,(()=>{try{return new DOMException("","InvalidStateError")}catch(e){return e.code=11,e.name="InvalidStateError",e}}),(r=(e=>()=>{if(null===e)throw new Error("A native EventTarget could not be created.");return e.document.createElement("p")})(window),class{constructor(){this._listeners=new WeakMap,this._nativeEventTarget=r()}addEventListener(e,t,n){if(null!==t){let o=this._listeners.get(t);void 0===o&&(r=this,i=t,o=e=>{const t={value:r};return Object.defineProperties(e,{currentTarget:t,target:t}),"function"==typeof i?i.call(r,e):i.handleEvent.call(r,e)},"function"==typeof t&&this._listeners.set(t,o)),this._nativeEventTarget.addEventListener(e,o,n)}var r,i}dispatchEvent(e){return this._nativeEventTarget.dispatchEvent(e)}removeEventListener(e,t,n){const r=null===t?void 0:this._listeners.get(t);this._nativeEventTarget.removeEventListener(e,void 0===r?null:r,n)}}),e,performance,setTimeout,t);var r,i,o;function s(e){return"function"==typeof e}function u(e){return function(t){if(function(e){return s(null==e?void 0:e.lift)}(t))return t.lift((function(t){try{return e(t,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")}}var c=function(e,t){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},c(e,t)};function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function l(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(u){return function(c){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&u[0]?r.return:u[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,u[1])).done)return i;switch(r=0,i&&(u=[2&u[0],i.value]),u[0]){case 0:case 1:i=u;break;case 4:return s.label++,{value:u[1],done:!1};case 5:s.label++,r=u[1],u=[0];continue;case 7:u=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==u[0]&&2!==u[0])){s=0;continue}if(3===u[0]&&(!i||u[1]>i[0]&&u[1]<i[3])){s.label=u[1];break}if(6===u[0]&&s.label<i[1]){s.label=i[1],i=u;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(u);break}i[2]&&s.ops.pop(),s.trys.pop();continue}u=t.call(e,s)}catch(e){u=[6,e],r=0}finally{n=i=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}}function h(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function d(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function f(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function p(e){return this instanceof p?(this.v=e,this):new p(e)}function v(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),o=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(e){i[e]&&(r[e]=function(t){return new Promise((function(n,r){o.push([e,t,n,r])>1||u(e,t)}))})}function u(e,t){try{(n=i[e](t)).value instanceof p?Promise.resolve(n.value.v).then(c,a):l(o[0][2],n)}catch(e){l(o[0][3],e)}var n}function c(e){u("next",e)}function a(e){u("throw",e)}function l(e,t){e(t),o.shift(),o.length&&u(o[0][0],o[0][1])}}function y(e){var t=e((function(e){Error.call(e),e.stack=(new Error).stack}));return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}Object.create,Object.create;var b=y((function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}}));function m(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var _=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var e,t,n,r,i;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var u=h(o),c=u.next();!c.done;c=u.next())c.value.remove(this)}catch(t){e={error:t}}finally{try{c&&!c.done&&(t=u.return)&&t.call(u)}finally{if(e)throw e.error}}else o.remove(this);var a=this.initialTeardown;if(s(a))try{a()}catch(e){i=e instanceof b?e.errors:[e]}var l=this._finalizers;if(l){this._finalizers=null;try{for(var p=h(l),v=p.next();!v.done;v=p.next()){var y=v.value;try{E(y)}catch(e){i=null!=i?i:[],e instanceof b?i=f(f([],d(i)),d(e.errors)):i.push(e)}}}catch(e){n={error:e}}finally{try{v&&!v.done&&(r=p.return)&&r.call(p)}finally{if(n)throw n.error}}}if(i)throw new b(i)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)E(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&m(t,e)},e.prototype.remove=function(t){var n=this._finalizers;n&&m(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e;var t}(),g=_.EMPTY;function w(e){return e instanceof _||e&&"closed"in e&&s(e.remove)&&s(e.add)&&s(e.unsubscribe)}function E(e){s(e)?e():e.unsubscribe()}var x=null,S=null,I=void 0,P=!1,T=!1,A={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=A.delegate;return(null==i?void 0:i.setTimeout)?i.setTimeout.apply(i,f([e,t],d(n))):setTimeout.apply(void 0,f([e,t],d(n)))},clearTimeout:function(e){var t=A.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function O(e){A.setTimeout((function(){if(!x)throw e;x(e)}))}function k(){}var N=L("C",void 0,void 0);function L(e,t,n){return{kind:e,value:t,error:n}}var C=null;function D(e){if(P){var t=!C;if(t&&(C={errorThrown:!1,error:null}),e(),t){var n=C,r=n.errorThrown,i=n.error;if(C=null,r)throw i}}else e()}var j=function(e){function t(t){var n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,w(t)&&t.add(n)):n.destination=z,n}return a(t,e),t.create=function(e,t,n){return new q(e,t,n)},t.prototype.next=function(e){this.isStopped?U(function(e){return L("N",e,void 0)}(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?U(L("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?U(N,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(_),R=Function.prototype.bind;function V(e,t){return R.call(e,t)}var M=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){F(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){F(e)}else F(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){F(e)}},e}(),q=function(e){function t(t,n,r){var i,o,u=e.call(this)||this;return s(t)||!t?i={next:null!=t?t:void 0,error:null!=n?n:void 0,complete:null!=r?r:void 0}:u&&T?((o=Object.create(t)).unsubscribe=function(){return u.unsubscribe()},i={next:t.next&&V(t.next,o),error:t.error&&V(t.error,o),complete:t.complete&&V(t.complete,o)}):i=t,u.destination=new M(i),u}return a(t,e),t}(j);function F(e){var t;P?(t=e,P&&C&&(C.errorThrown=!0,C.error=t)):O(e)}function U(e,t){var n=S;n&&A.setTimeout((function(){return n(e,t)}))}var z={closed:!0,next:k,error:function(e){throw e},complete:k};function Y(e,t,n,r,i){return new B(e,t,n,r,i)}var B=function(e){function t(t,n,r,i,o,s){var u=e.call(this,t)||this;return u.onFinalize=o,u.shouldUnsubscribe=s,u._next=n?function(e){try{n(e)}catch(e){t.error(e)}}:e.prototype._next,u._error=i?function(e){try{i(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,u._complete=r?function(){try{r()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,u}return a(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(j);function G(e,t){return u((function(n,r){var i=0;n.subscribe(Y(r,(function(n){r.next(e.call(t,n,i++))})))}))}var W=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function J(e){return s(null==e?void 0:e.then)}var $="function"==typeof Symbol&&Symbol.observable||"@@observable";function X(e){return e}function H(e){return 0===e.length?X:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var Z=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r,i=this,o=(r=e)&&r instanceof j||function(e){return e&&s(e.next)&&s(e.error)&&s(e.complete)}(r)&&w(r)?e:new q(e,t,n);return D((function(){var e=i,t=e.operator,n=e.source;o.add(t?t.call(o,n):n?i._subscribe(o):i._trySubscribe(o))})),o},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=K(t))((function(t,r){var i=new q({next:function(t){try{e(t)}catch(e){r(e),i.unsubscribe()}},error:r,complete:t});n.subscribe(i)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[$]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return H(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=K(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))},e.create=function(t){return new e(t)},e}();function K(e){var t;return null!==(t=null!=e?e:I)&&void 0!==t?t:Promise}function Q(e){return s(e[$])}function ee(e){return Symbol.asyncIterator&&s(null==e?void 0:e[Symbol.asyncIterator])}function te(e){return new TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var ne="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function re(e){return s(null==e?void 0:e[ne])}function ie(e){return v(this,arguments,(function(){var t,n,r;return l(this,(function(i){switch(i.label){case 0:t=e.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,p(t.read())];case 3:return n=i.sent(),r=n.value,n.done?[4,p(void 0)]:[3,5];case 4:return[2,i.sent()];case 5:return[4,p(r)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}function oe(e){return s(null==e?void 0:e.getReader)}function se(e){if(e instanceof Z)return e;if(null!=e){if(Q(e))return i=e,new Z((function(e){var t=i[$]();if(s(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if(W(e))return r=e,new Z((function(e){for(var t=0;t<r.length&&!e.closed;t++)e.next(r[t]);e.complete()}));if(J(e))return n=e,new Z((function(e){n.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,O)}));if(ee(e))return ue(e);if(re(e))return t=e,new Z((function(e){var n,r;try{for(var i=h(t),o=i.next();!o.done;o=i.next()){var s=o.value;if(e.next(s),e.closed)return}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}e.complete()}));if(oe(e))return ue(ie(e))}var t,n,r,i;throw te(e)}function ue(e){return new Z((function(t){(function(e,t){var n,r,i,o,s,u,c,a;return s=this,u=void 0,a=function(){var s,u;return l(this,(function(c){switch(c.label){case 0:c.trys.push([0,5,6,11]),n=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=h(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,i){!function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)}(r,i,(t=e[n](t)).done,t.value)}))}}}(e),c.label=1;case 1:return[4,n.next()];case 2:if((r=c.sent()).done)return[3,4];if(s=r.value,t.next(s),t.closed)return[2];c.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return u=c.sent(),i={error:u},[3,11];case 6:return c.trys.push([6,,9,10]),r&&!r.done&&(o=n.return)?[4,o.call(n)]:[3,8];case 7:c.sent(),c.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}}))},new((c=void 0)||(c=Promise))((function(e,t){function n(e){try{i(a.next(e))}catch(e){t(e)}}function r(e){try{i(a.throw(e))}catch(e){t(e)}}function i(t){var i;t.done?e(t.value):(i=t.value,i instanceof c?i:new c((function(e){e(i)}))).then(n,r)}i((a=a.apply(s,u||[])).next())}))})(e,t).catch((function(e){return t.error(e)}))}))}function ce(e,t,n,r,i){void 0===r&&(r=0),void 0===i&&(i=!1);var o=t.schedule((function(){n(),i?e.add(this.schedule(null,r)):this.unsubscribe()}),r);if(e.add(o),!i)return o}function ae(e,t,n,r,i,o,s,u){var c=[],a=0,l=0,h=!1,d=function(){!h||c.length||a||t.complete()},f=function(e){return a<r?p(e):c.push(e)},p=function(e){o&&t.next(e),a++;var u=!1;se(n(e,l++)).subscribe(Y(t,(function(e){null==i||i(e),o?f(e):t.next(e)}),(function(){u=!0}),void 0,(function(){if(u)try{a--;for(var e=function(){var e=c.shift();s?ce(t,s,(function(){return p(e)})):p(e)};c.length&&a<r;)e();d()}catch(e){t.error(e)}})))};return e.subscribe(Y(t,f,(function(){h=!0,d()}))),function(){null==u||u()}}function le(e,t,n){return void 0===n&&(n=1/0),s(t)?le((function(n,r){return G((function(e,i){return t(n,e,r,i)}))(se(e(n,r)))}),n):("number"==typeof t&&(n=t),u((function(t,r){return ae(t,r,e,n)})))}function he(e){return void 0===e&&(e=1/0),le(X,e)}var de=new Z((function(e){return e.complete()}));function fe(e){return e&&s(e.schedule)}function pe(e){return e[e.length-1]}function ve(e){return s(pe(e))?e.pop():void 0}function ye(e){return fe(pe(e))?e.pop():void 0}function be(e,t){return"number"==typeof pe(e)?e.pop():t}function me(e,t){return void 0===t&&(t=0),u((function(n,r){n.subscribe(Y(r,(function(n){return ce(r,e,(function(){return r.next(n)}),t)}),(function(){return ce(r,e,(function(){return r.complete()}),t)}),(function(n){return ce(r,e,(function(){return r.error(n)}),t)})))}))}function _e(e,t){return void 0===t&&(t=0),u((function(n,r){r.add(e.schedule((function(){return n.subscribe(r)}),t))}))}function ge(e,t){if(!e)throw new Error("Iterable cannot be null");return new Z((function(n){ce(n,t,(function(){var r=e[Symbol.asyncIterator]();ce(n,t,(function(){r.next().then((function(e){e.done?n.complete():n.next(e.value)}))}),0,!0)}))}))}function we(e,t){return t?function(e,t){if(null!=e){if(Q(e))return function(e,t){return se(e).pipe(_e(t),me(t))}(e,t);if(W(e))return function(e,t){return new Z((function(n){var r=0;return t.schedule((function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())}))}))}(e,t);if(J(e))return function(e,t){return se(e).pipe(_e(t),me(t))}(e,t);if(ee(e))return ge(e,t);if(re(e))return function(e,t){return new Z((function(n){var r;return ce(n,t,(function(){r=e[ne](),ce(n,t,(function(){var e,t,i;try{t=(e=r.next()).value,i=e.done}catch(e){return void n.error(e)}i?n.complete():n.next(t)}),0,!0)})),function(){return s(null==r?void 0:r.return)&&r.return()}}))}(e,t);if(oe(e))return function(e,t){return ge(ie(e),t)}(e,t)}throw te(e)}(e,t):se(e)}function Ee(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=ye(e),r=be(e,1/0),i=e;return i.length?1===i.length?se(i[0]):he(r)(we(i,n)):de}function xe(e,t){var n=s(e)?e:function(){return e},r=function(e){return e.error(n())};return new Z(t?function(e){return t.schedule(r,0,e)}:r)}function Se(e){return u((function(t,n){try{t.subscribe(n)}finally{n.add(e)}}))}const Ie=Symbol.observable||"@@observable",Pe=()=>{},Te=e=>{throw e},Ae=e=>(e.error(new Error("The required browser API seems to be not supported.")),()=>{}),Oe="undefined"==typeof window?null:window,ke=((e,t)=>{const n=()=>{};return e=>{const r=(...r)=>{const i=e((e=>"function"==typeof e[0])(r)?t({next:r[0]}):t(...r));return void 0!==i?i:n};return r[Symbol.observable]=()=>({subscribe:(...e)=>({unsubscribe:r(...e)})}),i=r,Symbol.observable||("function"==typeof i&&i.prototype&&i.prototype[Symbol.observable]?(i.prototype[Ie]=i.prototype[Symbol.observable],delete i.prototype[Symbol.observable]):(i[Ie]=i[Symbol.observable],delete i[Symbol.observable])),i;var i}})(0,(function(e){return e?e.next&&e.error&&e.complete?e:{complete:(e.complete??Pe).bind(e),error:(e.error??Te).bind(e),next:(e.next??Pe).bind(e)}:{complete:Pe,error:Te,next:Pe}})),Ne=((e,t,n)=>()=>n((n=>{if(null===t||void 0===t.cancelAnimationFrame||void 0===t.requestAnimationFrame)return e(n);let r=t.requestAnimationFrame((function e(i){r=t.requestAnimationFrame(e),n.next(i)}));return()=>t.cancelAnimationFrame(r)})))(Ae,Oe,ke),Le=(((e,t,n)=>{})(Ae,Oe,ke),(e=>{})(ke),(e=>{})(ke),(e=>(t,n,r)=>e((e=>{const i=t=>e.next(t);return t.addEventListener(n,i,r),()=>t.removeEventListener(n,i,r)})))(ke)),Ce=((e,t,n)=>()=>n((n=>{if(null===t||void 0===t.navigator||void 0===t.navigator.onLine)return e(n);const r=()=>n.next(!1),i=()=>n.next(!0);return t.addEventListener("offline",r),t.addEventListener("online",i),n.next(t.navigator.onLine),()=>{t.removeEventListener("offline",r),t.removeEventListener("online",i)}})))(Ae,Oe,ke);var De=y((function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}})),je=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return a(t,e),t.prototype.lift=function(e){var t=new Re(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new De},t.prototype.next=function(e){var t=this;D((function(){var n,r;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var i=h(t.currentObservers),o=i.next();!o.done;o=i.next())o.value.next(e)}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}}))},t.prototype.error=function(e){var t=this;D((function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var n=t.observers;n.length;)n.shift().error(e)}}))},t.prototype.complete=function(){var e=this;D((function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}}))},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,n=this,r=n.hasError,i=n.isStopped,o=n.observers;return r||i?g:(this.currentObservers=null,o.push(e),new _((function(){t.currentObservers=null,m(o,e)})))},t.prototype._checkFinalizedStatuses=function(e){var t=this,n=t.hasError,r=t.thrownError,i=t.isStopped;n?e.error(r):i&&e.complete()},t.prototype.asObservable=function(){var e=new Z;return e.source=this,e},t.create=function(e,t){return new Re(e,t)},t}(Z),Re=function(e){function t(t,n){var r=e.call(this)||this;return r.destination=t,r.source=n,r}return a(t,e),t.prototype.next=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)},t.prototype.error=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:g},t}(je);function Ve(){return he(1)}function Me(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Ve()(we(e,ye(e)))}var qe=y((function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}}));function Fe(e,t){return u((function(n,r){var i=0;n.subscribe(Y(r,(function(n){return e.call(t,n,i++)&&r.next(n)})))}))}function Ue(e){return e<=0?function(){return de}:u((function(t,n){var r=0;t.subscribe(Y(n,(function(t){++r<=e&&(n.next(t),e<=r&&n.complete())})))}))}function ze(e){return u((function(t,n){var r=!1;t.subscribe(Y(n,(function(e){r=!0,n.next(e)}),(function(){r||n.next(e),n.complete()})))}))}function Ye(e){return void 0===e&&(e=Be),u((function(t,n){var r=!1;t.subscribe(Y(n,(function(e){r=!0,n.next(e)}),(function(){return r?n.complete():n.error(e())})))}))}function Be(){return new qe}function Ge(){return u((function(e,t){e.subscribe(Y(t,k))}))}function We(e){return new Z((function(t){se(e()).subscribe(t)}))}function Je(e,t){return s(t)?le(e,t,1):le(e,1)}function $e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=ye(e);return we(e,n)}var Xe=function(e){function t(t,n){return e.call(this)||this}return a(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(_),He={setInterval:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=He.delegate;return(null==i?void 0:i.setInterval)?i.setInterval.apply(i,f([e,t],d(n))):setInterval.apply(void 0,f([e,t],d(n)))},clearInterval:function(e){var t=He.delegate;return((null==t?void 0:t.clearInterval)||clearInterval)(e)},delegate:void 0},Ze=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r.pending=!1,r}return a(t,e),t.prototype.schedule=function(e,t){var n;if(void 0===t&&(t=0),this.closed)return this;this.state=e;var r=this.id,i=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(i,r,t)),this.pending=!0,this.delay=t,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(i,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),He.setInterval(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!=n&&this.delay===n&&!1===this.pending)return t;null!=t&&He.clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n,r=!1;try{this.work(e)}catch(e){r=!0,n=e||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),n},t.prototype.unsubscribe=function(){if(!this.closed){var t=this.id,n=this.scheduler,r=n.actions;this.work=this.state=this.scheduler=null,this.pending=!1,m(r,this),null!=t&&(this.id=this.recycleAsyncId(n,t,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(Xe),Ke={now:function(){return(Ke.delegate||Date).now()},delegate:void 0},Qe=function(){function e(t,n){void 0===n&&(n=e.now),this.schedulerActionCtor=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.schedulerActionCtor(this,e).schedule(n,t)},e.now=Ke.now,e}(),et=new(function(e){function t(t,n){void 0===n&&(n=Qe.now);var r=e.call(this,t,n)||this;return r.actions=[],r._active=!1,r}return a(t,e),t.prototype.flush=function(e){var t=this.actions;if(this._active)t.push(e);else{var n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}(Qe))(Ze),tt=et;function nt(e,t,n){void 0===e&&(e=0),void 0===n&&(n=tt);var r=-1;return null!=t&&(fe(t)?n=t:r=t),new Z((function(t){var i,o=(i=e)instanceof Date&&!isNaN(i)?+e-n.now():e;o<0&&(o=0);var s=0;return n.schedule((function(){t.closed||(t.next(s++),0<=r?this.schedule(void 0,r):t.complete())}),o)}))}function rt(e){return u((function(t,n){var r,i=null,o=!1;i=t.subscribe(Y(n,void 0,void 0,(function(s){r=se(e(s,rt(e)(t))),i?(i.unsubscribe(),i=null,r.subscribe(n)):o=!0}))),o&&(i.unsubscribe(),i=null,r.subscribe(n))}))}function it(e,t,n){var r=s(e)||t||n?{next:e,error:t,complete:n}:e;return r?u((function(e,t){var n;null===(n=r.subscribe)||void 0===n||n.call(r);var i=!0;e.subscribe(Y(t,(function(e){var n;null===(n=r.next)||void 0===n||n.call(r,e),t.next(e)}),(function(){var e;i=!1,null===(e=r.complete)||void 0===e||e.call(r),t.complete()}),(function(e){var n;i=!1,null===(n=r.error)||void 0===n||n.call(r,e),t.error(e)}),(function(){var e,t;i&&(null===(e=r.unsubscribe)||void 0===e||e.call(r)),null===(t=r.finalize)||void 0===t||t.call(r)})))})):X}var ot={connector:function(){return new je}};function st(e,t){void 0===t&&(t=ot);var n=t.connector;return u((function(t,r){var i,o=n();se(e((i=o,new Z((function(e){return i.subscribe(e)}))))).subscribe(r),r.add(t.subscribe(o))}))}function ut(e,t,n){return We((function(){return e()?t:n}))}function ct(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return Me(t,$e.apply(void 0,f([],d(e))))}}function at(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=ye(e);return u((function(t,r){(n?Me(e,t,n):Me(e,t)).subscribe(r)}))}var lt=Array.isArray;function ht(e){return 1===e.length&&lt(e[0])?e[0]:e}function dt(e,t){return void 0===e&&(e=0),void 0===t&&(t=et),e<0&&(e=0),nt(e,e,t)}function ft(e,t,n,r,i){return function(o,s){var u=n,c=t,a=0;o.subscribe(Y(s,(function(t){var n=a++;c=u?e(c,t,n):(u=!0,t),r&&s.next(c)}),i&&function(){u&&s.next(c),s.complete()}))}}function pt(e,t){return u(ft(e,t,arguments.length>=2,!0))}function vt(e,t){return void 0===t&&(t=X),e=null!=e?e:yt,u((function(n,r){var i,o=!0;n.subscribe(Y(r,(function(n){var s=t(n);!o&&e(i,s)||(o=!1,i=s,r.next(n))})))}))}function yt(e,t){return e===t}const bt=Symbol();function mt(e){return u((function(t,n){se(e).subscribe(Y(n,(function(){return n.complete()}),k)),!n.closed&&t.subscribe(n)}))}function _t(e){return function(e,t){return u(ft(e,t,arguments.length>=2,!1,!0))}((function(t,n,r){return!e||e(n,r)?t+1:t}),0)}function gt(e){var t;void 0===e&&(e=1/0);var n=(t=e&&"object"==typeof e?e:{count:e}).count,r=void 0===n?1/0:n,i=t.delay,o=t.resetOnSuccess,s=void 0!==o&&o;return r<=0?X:u((function(e,t){var n,o=0,u=function(){var c=!1;n=e.subscribe(Y(t,(function(e){s&&(o=0),t.next(e)}),void 0,(function(e){if(o++<r){var s=function(){n?(n.unsubscribe(),n=null,u()):c=!0};if(null!=i){var a="number"==typeof i?nt(i):se(i(e,o)),l=Y(t,(function(){l.unsubscribe(),s()}),(function(){t.complete()}));a.subscribe(l)}else s()}else t.error(e)}))),c&&(n.unsubscribe(),n=null,u())};u()}))}var wt;!function(e){e.NEXT="N",e.ERROR="E",e.COMPLETE="C"}(wt||(wt={}));var Et=function(){function e(e,t,n){this.kind=e,this.value=t,this.error=n,this.hasValue="N"===e}return e.prototype.observe=function(e){return xt(this,e)},e.prototype.do=function(e,t,n){var r=this,i=r.kind,o=r.value,s=r.error;return"N"===i?null==e?void 0:e(o):"E"===i?null==t?void 0:t(s):null==n?void 0:n()},e.prototype.accept=function(e,t,n){var r;return s(null===(r=e)||void 0===r?void 0:r.next)?this.observe(e):this.do(e,t,n)},e.prototype.toObservable=function(){var e=this,t=e.kind,n=e.value,r=e.error,i="N"===t?$e(n):"E"===t?xe((function(){return r})):"C"===t?de:0;if(!i)throw new TypeError("Unexpected notification kind "+t);return i},e.createNext=function(t){return new e("N",t)},e.createError=function(t){return new e("E",void 0,t)},e.createComplete=function(){return e.completeNotification},e.completeNotification=new e("C"),e}();function xt(e,t){var n,r,i,o=e,s=o.kind,u=o.value,c=o.error;if("string"!=typeof s)throw new TypeError('Invalid notification, missing "kind"');"N"===s?null===(n=t.next)||void 0===n||n.call(t,u):"E"===s?null===(r=t.error)||void 0===r||r.call(t,c):null===(i=t.complete)||void 0===i||i.call(t)}class St{constructor(e){this.callback=e}call(e,t){return t.subscribe(new It(e,this.callback))}}class It extends j{constructor(e,t){super(e),this.add(new _((()=>t(this.notification))))}complete(){this.notification=new Et("C"),super.complete()}error(e){this.notification=new Et("E",void 0,e),super.error(e)}}const Pt=e=>new Z((t=>{let n=!0;return e.then((e=>{n&&(t.next(e),t.complete())}),(e=>{n&&t.error(e)})),()=>n=!1})),Tt=(e,t)=>G((([n,r])=>new Z((i=>{const o=[],s=new je,c=[],a=()=>Pt(_.createOffer()).pipe(le((e=>Pt(_.setLocalDescription(e)).pipe(it((()=>t({...P(e),client:{id:n},version:S}))))))),l=()=>Le(_,"icecandidate")((({candidate:e})=>{null===e?t({client:{id:n},numberOfGatheredCandidates:m,type:"summary",version:S}):9!==e.port&&"tcp"!==e.protocol&&(t({...e.toJSON(),client:{id:n},type:"candidate",version:S}),m+=1)})),h=e=>{const t=[Le(e,"close")((()=>s.next(new Error('RTCDataChannel fired unexpected event of type "close".')))),Le(e,"closing")((()=>s.next(new Error('RTCDataChannel fired unexpected event of type "closing".')))),Le(e,"error")((()=>s.next(new Error('RTCDataChannel fired unexpected event of type "error".'))))],n=[null!==v,we(Le(e,"message")).pipe(G((e=>JSON.parse(e.data))),mt(Ee(Le(e,"close"),Le(e,"closing"),Le(e,"error")))),t=>{"open"===e.readyState&&e.send(JSON.stringify(t))}];return"open"===e.readyState?i.next(n):t.push(Le(e,"open")((()=>i.next(n)))),()=>t.forEach((e=>e()))},d=()=>{const e=[Le(_,"connectionstatechange")((()=>{const e=_.connectionState;["closed","disconnected","failed"].includes(e)&&s.next(new Error(`RTCPeerConnection transitioned to unexpected connectionState "${e}".`))})),Le(_,"datachannel")((({channel:e})=>{p=e,E=h(e)})),Le(_,"iceconnectionstatechange")((()=>{const e=_.iceConnectionState;["closed","disconnected","failed"].includes(e)&&s.next(new Error(`RTCPeerConnection transitioned to unexpected iceConnectionState "${e}".`))})),Le(_,"signalingstatechange")((()=>{"closed"===_.signalingState&&s.next(new Error('RTCPeerConnection transitioned to unexpected signalingState "closed".'))}))];return()=>e.forEach((e=>e()))},f=t=>{w(),null==E||E(),x(),"open"===(null==p?void 0:p.readyState)&&i.next(null),null==p||p.close(),_.close(),p=null,y=0,b=1/0,m=0,_=e(),c.length=0,w=l(),E=null,x=d(),S=t};let p=null,v=null,y=0,b=1/0,m=0,_=e(),g=null,w=l(),E=null,x=d(),S=0;const I=async e=>{y+=e,y===b&&await _.addIceCandidate()},P=e=>e instanceof RTCSessionDescription?e.toJSON():e;return i.next(null),Ee(We((()=>we(o))),s.pipe(le((e=>xe((()=>e))))),r.pipe(((e,t,n)=>r=>{return r.pipe(u((function(e,t){e.subscribe(Y(t,(function(e){t.next(Et.createNext(e))}),(function(){t.next(Et.createComplete()),t.complete()}),(function(e){t.next(Et.createError(e)),t.complete()})))})),(i=r=>Me($e(r),"N"===r.kind?n.pipe(function(e,t){return void 0===t&&(t=!1),u((function(n,r){var i=0;n.subscribe(Y(r,(function(n){var o=e(n,i++);(o||t)&&r.next(n),!o&&r.complete()})))}))}(t),it(e),Ge()):de),u((function(e,t){var n=null,r=!1,o=function(){return r&&!n&&t.complete()};e.subscribe(Y(t,(function(e){null==n||n.unsubscribe(),se(i(e)).subscribe(n=Y(t,(function(e){return t.next(e)}),(function(){n=null,o()})))}),(function(){r=!0,o()})))}))),u((function(e,t){e.subscribe(Y(t,(function(e){return xt(e,t)})))})));var i})((()=>t({client:{id:n},type:"check"})),(()=>null===p||"connecting"===p.readyState),dt(5e3)),(T=e=>{void 0!==e&&s.complete()},e=>e.lift(new St(T))))).pipe(Je((e=>(e=>{const{type:r}=e;if("answer"===r&&null!==v){if(S>e.version)return de;if(S===e.version)return Pt(_.setRemoteDescription(e)).pipe(le((()=>we(c))),Je((e=>Pt(_.addIceCandidate(e)))),_t(),le((e=>Pt(I(e)))))}if("candidate"===r){if(S>e.version)return de;if(null===v&&S<e.version&&f(e.version),S===e.version)return null===_.remoteDescription?(c.push(e),de):Pt(_.addIceCandidate(e)).pipe(le((()=>Pt(I(1)))))}if("error"===r&&null!==v)return S>e.version?de:(f(e.version+1),p=_.createDataChannel(v,{ordered:!0}),E=h(p),a());if("notice"===r&&null===v)return de;if("offer"===r&&null===v)return S>e.version?de:(S<e.version&&f(e.version),Pt(_.setRemoteDescription(e)).pipe(le((()=>Pt(_.createAnswer()))),le((e=>Pt(_.setLocalDescription(e)).pipe(it((()=>t({...P(e),client:{id:n},version:S})))))),le((()=>we(c))),Je((e=>Pt(_.addIceCandidate(e)))),_t(),le((e=>Pt(I(e))))));if("request"===r&&v===e.label)return de;if("request"===r&&null===p&&null===v&&0===S)return v=e.label,p=_.createDataChannel(v,{ordered:!0}),E=h(p),a();if("summary"===r){if(S>e.version)return de;if(null===v&&S<e.version&&f(e.version),S===e.version)return b=e.numberOfGatheredCandidates,Pt(I(0))}return g=new Error(`The current event of type "${r}" can't be processed.`),xe((()=>g))})(e))),gt({delay:e=>{if(e===g)return xe((()=>e));o.length=0;const r={client:{id:n},type:"error",version:S};return null===v?(t(r),f(S+1)):o.push(r),$e(null)}}),Se((()=>{w(),null==E||E(),x(),null==p||p.close(),_.close()}))).subscribe({complete:()=>i.complete(),error:e=>i.error(e)});var T}))));function At(e,t){return function(n,r){return!e.call(t,n,r)}}const Ot=/^[\dA-Za-z]{20}$/,kt=((n,r,i,o)=>class extends r{constructor(e){super();const t=i.now()/1e3;this._endPosition=Number.POSITIVE_INFINITY,this._error=null,this._hops=[],this._onadjust=null,this._onchange=null,this._onreadystatechange=null,this._origin=Number.MAX_SAFE_INTEGER,this._providerIdOrUrl=e,this._readyState="connecting",this._skew=0,this._startPosition=Number.NEGATIVE_INFINITY,this._subscription=null,this._updateRequestsSubject=new je,this._vector={acceleration:0,position:0,timestamp:t,velocity:0},this._version=0,this._createClient()}get endPosition(){return this._endPosition}get error(){return this._error}get onadjust(){return null===this._onadjust?this._onadjust:this._onadjust[0]}set onadjust(e){if(null!==this._onadjust&&this.removeEventListener("adjust",this._onadjust[1]),"function"==typeof e){const t=e.bind(this);this.addEventListener("adjust",t),this._onadjust=[e,t]}else this._onadjust=null}get onchange(){return null===this._onchange?this._onchange:this._onchange[0]}set onchange(e){if(null!==this._onchange&&this.removeEventListener("change",this._onchange[1]),"function"==typeof e){const t=e.bind(this);this.addEventListener("change",t),this._onchange=[e,t]}else this._onchange=null}get onreadystatechange(){return null===this._onreadystatechange?this._onreadystatechange:this._onreadystatechange[0]}set onreadystatechange(e){if(null!==this._onreadystatechange&&this.removeEventListener("readystatechange",this._onreadystatechange[1]),"function"==typeof e){const t=e.bind(this);this.addEventListener("readystatechange",t),this._onreadystatechange=[e,t]}else this._onreadystatechange=null}get readyState(){return this._readyState}get skew(){return this._skew}get startPosition(){return this._startPosition}get vector(){return this._vector}destroy(){if(null===this._subscription)throw new Error("The timingProvider is already destroyed.");this._readyState="closed",this._subscription.unsubscribe(),this._subscription=null,this._updateRequestsSubject.complete(),o((()=>this.dispatchEvent(new Event("readystatechange"))))}update(n){return null===this._subscription?Promise.reject(new Error("The timingProvider is destroyed and can't be updated.")):(this._updateRequestsSubject.next([{...t(this._vector,i.now()/1e3-this._vector.timestamp),...e(n),hops:[],version:this._version+1},null]),Promise.resolve())}_createClient(){const e=Ot.test(this._providerIdOrUrl)?`wss://matchmaker.suenc.io?providerId=${this._providerIdOrUrl}`:this._providerIdOrUrl;this._subscription=Me(we(Ce()).pipe((!0,e=>e.pipe(Fe((e=>true===e)))),function(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?Fe((function(t,n){return e(t,n,r)})):X,Ue(1),n?ze(t):Ye((function(){return new qe})))}}(),Ge()),We((()=>{const[t,r]=n(e);return t.pipe((i=e=>"closure"===e.type,o=()=>{const e=new Error("Your plan has exceeded its quota.");this._error=e,this._readyState="closed",this.dispatchEvent(new Event("readystatechange"))},st((e=>{const[t,n]=(r=e,[Fe(s=i,u)(se(r)),Fe(At(s,u))(se(r))]);var r,s,u;return n.pipe(mt(t.pipe(it(o))))}))),(s=e=>"init"===e.type,e=>e.pipe(pt((([e,t],n)=>{if(s(n)){if(null===t)throw new Error("Another value has been identified as the first value already.");return[[n,...t],null]}return null===t?[[n],t]:[e,[...t,n]]}),[[],[]]),Je((([e])=>we(e))))),Je((e=>{if("init"===e.type){const{events:t,origin:n}=e;return this._origin=n,0===t.length&&"connecting"===this._readyState&&(this._readyState="open",this.dispatchEvent(new Event("readystatechange"))),we(t)}return $e(e)})),(e=>t=>new Z((n=>{const r=new Map;return t.pipe(Se((()=>{r.forEach((([e,t])=>{null===e?t.unsubscribe():e.complete()}))}))).subscribe({complete(){n.complete()},error(e){n.error(e)},next(t){var i;const o=t.client.id,[s,u]=null!==(i=r.get(o))&&void 0!==i?i:[null,null];if("termination"===t.type)null!==u&&u.unsubscribe(),null!==s&&s.complete(),r.set(o,[null,e.pipe(Ue(1)).subscribe((()=>r.delete(o)))]);else if(null===s&&null===u){const e=new je;r.set(o,[e,null]),n.next([o,e]),e.next(t)}else null!==s&&s.next(t)}})})))(nt(1e4)),Tt((()=>new RTCPeerConnection({iceServers:[{urls:["stun:stun.l.google.com:19302","stun:stun1.l.google.com:19302"]}]})),r));var i,o,s}))).pipe((e=>We((()=>{let t=0;return e.pipe(gt({delay:e=>(t+=1,ut((()=>t<4),nt(1e3*t**2),xe((()=>e))))}),it((()=>t=0)))}))),rt((e=>(this._error=e,this._readyState="closed",this.dispatchEvent(new Event("readystatechange")),de))),(e=>e.pipe(le(((e,t)=>e.pipe(G((e=>[t,e])),ct([t,bt])))),pt(((e,[t,n])=>n===bt?(e.delete(t),e):e.set(t,n)),new Map),G((e=>Array.from(e.values()))))),it((e=>{(0===e.length||e.some((e=>null!==e)))&&"connecting"===this._readyState&&(this._readyState="open",this.dispatchEvent(new Event("readystatechange")))})),(e=>new Z((t=>{const n=new WeakSet;return e.pipe(le((e=>{const t=e.filter((e=>null!==e&&!n.has(e)));return t.forEach((e=>n.add(e))),we(t)}))).subscribe(t)}))),st((e=>{const t=e.pipe(G((e=>[e,!0])),(n=([e,t])=>ut((()=>t),e[1].pipe(Ge(),ct([e,!1])),de),void 0===r&&(r=1/0),r=(r||0)<1?1/0:r,u((function(e,t){return ae(e,t,n,r,void 0,!0,undefined)}))),pt(((e,[t,n])=>{const r=e.indexOf(t);if(r>-1){if(n)throw new Error("The array does already contain the value to be added.");return[...e.slice(0,r),...e.slice(r+1)]}if(!n)throw new Error("The array doesn't contain the value to be removed.");return[...e,t]}),[]),at([]));var n,r;return Ee(e.pipe(it((([e,,t])=>{e&&this._sendUpdate(t)})),le((([,e,t])=>{t({type:"ping"});const n=i.now();return e.pipe(("type",r=e=>e.type,u((function(e,t){var n;o&&"function"!=typeof o?(s=o.duration,n=o.element,c=o.connector):n=o;var i=new Map,u=function(e){i.forEach(e),e(t)},a=function(e){return u((function(t){return t.error(e)}))},l=0,h=!1,d=new B(t,(function(e){try{var o=r(e),u=i.get(o);if(!u){i.set(o,u=c?c():new je);var f=(v=o,y=u,(b=new Z((function(e){l++;var t=y.subscribe(e);return function(){t.unsubscribe(),0==--l&&h&&d.unsubscribe()}}))).key=v,b);if(t.next(f),s){var p=Y(u,(function(){u.complete(),null==p||p.unsubscribe()}),void 0,void 0,(function(){return i.delete(o)}));d.add(se(s(f)).subscribe(p))}}u.next(n?n(e):e)}catch(e){a(e)}var v,y,b}),(function(){return u((function(e){return e.complete()}))}),a,(function(){return i.clear()}),(function(){return h=!0,0===l}));e.subscribe(d)}))),le((e=>"ping"===e.key?e.pipe(G((({timestamp:e})=>null!=e?e:i.now())),it((e=>t({message:[e,i.now()],type:"pong"}))),Ge()):"pong"===e.key?function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=ve(e),r=ht(e);return r.length?new Z((function(e){var t=r.map((function(){return[]})),i=r.map((function(){return!1}));e.add((function(){t=i=null}));for(var o=function(o){se(r[o]).subscribe(Y(e,(function(r){if(t[o].push(r),t.every((function(e){return e.length}))){var s=t.map((function(e){return e.shift()}));e.next(n?n.apply(void 0,f([],d(s))):s),t.some((function(e,t){return!e.length&&i[t]}))&&e.complete()}}),(function(){i[o]=!0,!t[o].length&&e.complete()})))},s=0;!e.closed&&s<r.length;s++)o(s);return function(){t=i=null}})):de}(dt(1e3).pipe(it((()=>t({type:"ping"}))),G((()=>i.now())),at(n)),e.pipe(G((({message:e,timestamp:t})=>[...e,null!=t?t:i.now()])))).pipe(G((([e,[t,n,r]])=>t-(e+t-n+r)/2)),pt(((e,t)=>[...e.slice(-4),t]),[]),G((e=>e.reduce(((e,t)=>e+t),0)/e.length)),G((e=>e/1e3)),G((e=>[1,e]))):e.pipe(G((({message:e})=>e)),G((e=>{if(this._version>e.version)return this._sendUpdate(t),null;if(this._version===e.version){const n=0===this._hops.length?this._origin:this._hops[0];if(n<e.hops[0])return this._sendUpdate(t),null;if(n===e.hops[0]&&this._hops.length+1<e.hops.length)return this._sendUpdate(t),null}return e})),G((e=>[0,e]))))),(a=[null,0],e=>e.pipe(pt(((e,[t,n])=>0===t?[n,e[1]]:[e[0],n]),a),at(a))),vt((([e,t],[n,r])=>e===n&&t===r)),G((([e,n])=>[null===e?e:{...e,timestamp:e.timestamp-n},t])),ct([null,t]));var r,o,s,c,a}))),this._updateRequestsSubject).pipe(pt((([,e]=[null,[[null,this._createExtendedVector(this._hops)]]],[t,n])=>{const r=e.findIndex((e=>e[0]===n));if(null!==t){if(this._version<t.version)return e.length=0,e.push([n,t]),[t,e];if(this._version===t.version){const i=0===this._hops.length?this._origin:this._hops[0];if(i>t.hops[0])return[t,[[n,t]]];if(i===t.hops[0]&&!t.hops.includes(this._origin)&&this._hops.length>0)return r>-1?e[r]=[n,t]:e.push([n,t]),e.sort((([,{hops:[e=this._origin,...t]}],[,{hops:[n=this._origin,...r]}])=>e===n?t.length-r.length:e-n)),[t,e]}}return r>-1&&(1===e.length?(e[0][0]=null,e[0][1]={...e[0][1],hops:[]}):e.splice(r,1)),[t,e]}),void 0),G((([e,[t]])=>[e,t])),vt((([,[,e]],[,[,t]])=>e===t)),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=ve(e);return u((function(t,r){for(var i=e.length,o=new Array(i),s=e.map((function(){return!1})),u=!1,c=function(t){se(e[t]).subscribe(Y(r,(function(e){o[t]=e,u||s[t]||(s[t]=!0,(u=s.every(X))&&(s=null))}),k))},a=0;a<i;a++)c(a);t.subscribe(Y(r,(function(e){if(u){var t=f([e],d(o));r.next(n?n.apply(void 0,f([],d(t))):t)}})))}))}(t))}))).subscribe((([[e,[t,n]],r])=>{const i={...n,hops:[...n.hops,this._origin]};r.forEach((([,,r])=>{n===e&&t===r||r({message:i,type:"update"})})),this._setInternalVector(n)}))}_createExtendedVector(e){return{...this._vector,hops:e,version:this._version}}_sendUpdate(e){e({message:this._createExtendedVector([...this._hops,this._origin]),type:"update"})}_setInternalVector({hops:e,version:t,...n}){this._hops=e,this._vector=n,this._version=t,this.dispatchEvent(new CustomEvent("change",{detail:n}))}})((Nt=e=>new WebSocket(e),e=>{const t=Nt(e);return[Ee(Le(t,"message"),Ee(Le(t,"close"),Le(t,"error")).pipe(le((({type:e})=>xe((()=>new Error(`WebSocket fired unexpected event of type "${e}".`))))))).pipe(Se((()=>t.close())),G((e=>JSON.parse(e.data)))),e=>t.send(JSON.stringify(e))]}),((e,t)=>class{constructor(){this._listeners=new WeakMap,this._nativeEventTarget=e()}addEventListener(e,t,n){if(null!==t){let o=this._listeners.get(t);void 0===o&&(r=this,i=t,o=e=>{const t={value:r};return Object.defineProperties(e,{currentTarget:t,target:t}),"function"==typeof i?i.call(r,e):i.handleEvent.call(r,e)},"function"==typeof t&&this._listeners.set(t,o)),this._nativeEventTarget.addEventListener(e,o,n)}var r,i}dispatchEvent(e){return this._nativeEventTarget.dispatchEvent(e)}removeEventListener(e,t,n){const r=null===t?void 0:this._listeners.get(t);this._nativeEventTarget.removeEventListener(e,void 0===r?null:r,n)}})((e=>()=>{if(null===e)throw new Error("A native EventTarget could not be created.");return e.document.createElement("p")})(window)),performance,setTimeout);var Nt;const Lt=[Number.MIN_VALUE,Number.MAX_VALUE],Ct=(e=>t=>(n,r,i)=>{let{lastAppliedPostion:o,lastAppliedTimestamp:s,lastAppliedVelocity:u,lastPlayheadDifference:c,mediaElementDelay:a,numberOfDetectedResets:l,numberOfExpectedResets:h}=null!=i?i:{lastAppliedPostion:0,lastAppliedTimestamp:0,lastAppliedVelocity:0,lastPlayheadDifference:0,mediaElementDelay:0,numberOfDetectedResets:0,numberOfExpectedResets:1};if(n.position<0||0===n.velocity)return o=n.position,u=n.velocity,{lastAppliedPostion:o,lastAppliedTimestamp:0,lastAppliedVelocity:u,lastPlayheadDifference:c,mediaElementDelay:a,numberOfDetectedResets:l,numberOfExpectedResets:h,position:o,velocity:u};if(u===n.velocity&&c<.5){const e=Math.abs(r-o)*u;if(e<.5)if(e+.001>c){if(c=e,l<h)return{lastAppliedPostion:o,lastAppliedTimestamp:s,lastAppliedVelocity:u,lastPlayheadDifference:c,mediaElementDelay:a,numberOfDetectedResets:l,numberOfExpectedResets:h,position:r,velocity:u}}else{if(c=e,l+=1,l<=h)return{lastAppliedPostion:o,lastAppliedTimestamp:s,lastAppliedVelocity:u,lastPlayheadDifference:c,mediaElementDelay:a,numberOfDetectedResets:l,numberOfExpectedResets:h,position:r,velocity:u};h+=1}else c=e,h=Math.max(l,1)}else s=0;const d=Math.abs(r-n.position),f=0===u||u<0&&n.velocity>0||u>0&&n.velocity<0;if(d>t||f){if(s>0){const t=n.timestamp-s,{position:i}=e({acceleration:0,position:o,timestamp:s,velocity:u},t);a=i-r}return o=n.position+a,u=n.velocity,{lastAppliedPostion:o,lastAppliedTimestamp:n.timestamp,lastAppliedVelocity:u,lastPlayheadDifference:0,mediaElementDelay:a,numberOfDetectedResets:0,numberOfExpectedResets:h,position:o,velocity:u}}return{lastAppliedPostion:o,lastAppliedTimestamp:s,lastAppliedVelocity:u,lastPlayheadDifference:c,mediaElementDelay:a,numberOfDetectedResets:l,numberOfExpectedResets:h,position:r,velocity:n.velocity}})(t),Dt=(jt=e=>{e.paused||e.pause()},Rt=e=>{e.paused&&e.play().catch((e=>console.error(e)))},Ft=new WeakMap,Vt=(e,t,n)=>{const r=Ft.get(e);(void 0===r||Math.abs(r[0]-t)>1e-4||r[1]!==n)&&(e.currentTime=n,Ft.set(e,[e.currentTime,n]))},qt=new WeakMap,Mt=(e,t,n)=>{const r=qt.get(e);void 0!==r&&r[0]===t&&r[1]===n||(e.playbackRate=1===n?t>1?1.00001:.99999:n,qt.set(e,[e.playbackRate,n]))},(e,t,n,r,i,o)=>{i<0?(e>0&&Vt(n,e,0),jt(n)):i>=t?(e!==t&&Vt(n,e,t),jt(n)):e!==i?(Vt(n,e,i),0!==o?(r!==o&&Mt(n,r,o),Rt(n)):jt(n)):r!==o&&(0!==o?(Mt(n,r,o),Rt(n)):jt(n))});var jt,Rt,Vt,Mt,qt,Ft;const Ut=((e,t,n,r)=>(i,o,s,u=null)=>{let c=null;const a=()=>{const{currentTime:e,duration:t,playbackRate:n}=i,a=o.query();c=s(null===u?a:u(a),e,c);const l="number"!=typeof t||isNaN(t)?0:t,{position:h,velocity:d}=c;return r(e,l,i,n,h,d),0!==d};let l;const h=()=>{a()||(l(),l=f())},d=()=>{const r=[e()((()=>h())),n(o,"change")((()=>{"hidden"===t.visibilityState&&h()}))];return()=>r.forEach((e=>e()))},f=()=>n(o,"change")((()=>{a()&&(l(),l=d())}));return l=a()?d():f(),()=>l()})(Ne,document,Le,Dt),zt=((e,t,n,r,i,o,s)=>{return((e,t)=>(n,r,i=null)=>e(n,r,t,i))(o,null!==s&&s.navigator.userAgent.includes("Safari")&&!s.navigator.userAgent.includes("Chrome")?r(.025):((e,[t,n],r,i)=>({position:o,velocity:s},u,c)=>{let{mediaElementDelay:a}=null!=c?c:{mediaElementDelay:0};if(s<t||s>n)return{mediaElementDelay:a,position:o,velocity:0};if(o<0||0===s)return{mediaElementDelay:a,position:o,velocity:s};const l=u-o,h=Math.abs(l);if(h>r){const{position:e}=null!=c?c:{position:null};if(l<0||l>a)return e===u&&(a+=h),{mediaElementDelay:a,position:o+a,velocity:s};if(e!==u)return a-=h,{mediaElementDelay:a,position:o+a,velocity:s}}return h>i?{mediaElementDelay:a,position:u,velocity:e(l,t,n,s)}:{mediaElementDelay:a,position:u,velocity:s}})((u=.5,(e,t,n,r)=>{const i=(Math.abs(e)+u)/u;return Math.max(t,Math.min(n,e>0?r/i:i*r))}),(e=>{if(null===e)return Lt;const t=new e.Audio;try{t.playbackRate=17}catch{return[.0625,16]}try{t.playbackRate=-1}catch{return[0,Lt[1]]}return Lt})(s),1,.025));var u})(0,0,0,Ct,0,Ut,"undefined"==typeof window?null:window),Yt=document.getElementById("current-time-1"),Bt=document.getElementById("pause"),Gt=document.getElementById("play"),Wt=document.getElementById("position"),Jt=document.getElementById("reset"),$t=document.getElementById("skip-backward"),Xt=document.getElementById("skip-forward"),Ht=document.getElementById("unmute"),Zt=document.getElementById("player-1"),Kt=new n(new kt("ws://gdlsync.loca.lt"));Kt.addEventListener("readystatechange",(()=>{if("open"===Kt.readyState){Ht.addEventListener("click",(()=>{Zt.muted=!1,Zt.play})),Bt.addEventListener("click",(()=>{Kt.update({velocity:0})})),Gt.addEventListener("click",(()=>{const{position:e,velocity:t}=Kt.query();100===e&&0===t?Kt.update({position:0,velocity:1}):Kt.update({velocity:1})})),Jt.addEventListener("click",(()=>{Kt.update({position:0})})),$t.addEventListener("click",(()=>{const{position:e}=Kt.query();Kt.update({position:e-5})})),Xt.addEventListener("click",(()=>{const{position:e}=Kt.query();Kt.update({position:e+5})}));const e=()=>{const{position:t}=Kt.query();Yt.innerHTML=Zt.currentTime.toFixed(2),Wt.innerHTML=t.toFixed(2),requestAnimationFrame(e)};e(),zt(Zt,Kt)}}))})();